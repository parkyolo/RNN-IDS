#include <stdio.h> 
#include <math.h> 
#include <time.h> 
#include <string.h> 
#include "./include/k2c_include.h" 
#include "rnnIDS.h" 

float maxabs(k2c_tensor *tensor1, k2c_tensor *tensor2);
struct timeval GetTimeStamp(); 
 
int main(){
float test1_simple_rnn_input_input_array[122] = {
+5.37843637e-01,-1.88836291e-01,-4.83492443e-01,+1.81140622e+00,-1.86099774e+00,
-7.76191018e-01,+1.41377548e+00,-1.60629234e-01,+1.23583555e+00,+3.70754677e-01,
-1.86176001e+00,-7.72787736e-01,-1.49603420e+00,-1.28528720e+00,-4.08950943e-01,
-2.11542059e-01,+8.81075506e-01,-3.62868512e-01,+7.19862094e-01,+1.96479572e+00,
-4.63806535e-01,-1.35530338e+00,+5.25669886e-01,+8.82168931e-01,+1.32195834e+00,
+1.06233626e+00,+8.96650258e-02,-6.72739916e-01,+9.82219985e-01,-4.03094172e-01,
-1.47947411e+00,+3.67213750e-01,+1.26551173e+00,+1.98883413e-01,+4.09281291e-01,
-1.89057624e+00,-4.03903765e-01,-1.24106676e+00,+1.28061817e+00,-1.11189492e+00,
-1.76094834e+00,+1.12359746e+00,-1.21946703e+00,-7.43534699e-02,-5.01452533e-01,
-1.53265129e+00,-8.48721772e-01,-4.01272700e-01,-1.14242900e+00,+7.97058492e-01,
-1.02712216e+00,-8.39781357e-01,+2.66372723e-01,-1.67597742e+00,+1.66469078e+00,
+1.08460045e+00,+1.36489714e+00,+9.28636828e-01,-5.33716908e-01,+1.47292984e+00,
-4.52586919e-01,+1.73817956e+00,+6.27472656e-01,-1.55576468e-01,-7.19048188e-01,
-1.17263738e+00,-1.53029412e+00,-4.94281661e-01,-1.61099820e+00,+6.30714155e-01,
+1.96861613e-01,-7.60560678e-01,+2.64609737e-01,-1.17697601e+00,-6.08603842e-01,
+1.13649079e-01,-1.34337736e+00,+1.23854836e+00,+1.89671814e+00,+1.48723427e+00,
+5.86759337e-01,+1.58572575e+00,-1.60435796e+00,-1.20522313e+00,-1.20076357e-01,
+1.88059827e+00,+1.26162036e-01,+2.68296252e-01,+2.87708740e-01,-1.93088541e+00,
-1.66093014e+00,-1.43462663e+00,-2.09910783e-01,+1.69679129e+00,-1.41319263e+00,
+5.09478168e-01,-1.26638608e+00,-1.58937842e+00,-1.48051547e+00,+9.04854671e-01,
+1.00194428e+00,+1.78420542e+00,+1.18514341e+00,+1.80633118e+00,+3.88132873e-01,
+1.91883163e+00,-1.39335115e+00,+1.13398284e+00,+1.60523730e-01,+1.02187191e+00,
-6.54568963e-01,+5.70929366e-01,-1.84759610e+00,-9.08250765e-01,-5.54723632e-02,
-1.31837269e+00,+7.10338115e-01,-1.80978391e+00,-9.64052618e-02,+9.99959190e-01,
+7.87671002e-01,+9.16279485e-01,}; 
k2c_tensor test1_simple_rnn_input_input = {&test1_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test1_array[5] = {
+0.00000000e+00,+8.38167946e-24,+1.00000000e+00,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test1 = {&keras_dense_test1_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test1_array[5] = {0}; 
k2c_tensor c_dense_test1 = {&c_dense_test1_array[0],1,5,{5,1,1,1,1}}; 
float test2_simple_rnn_input_input_array[122] = {
-7.45000145e-01,+6.11638825e-01,+9.09626839e-01,-1.60042267e+00,-1.79664647e+00,
+1.72286483e+00,-7.21323719e-01,+7.91555554e-01,+1.80758143e+00,+1.01757413e+00,
-1.51870691e+00,-3.89573558e-01,-2.36496850e-01,+6.99710758e-02,+1.41580095e+00,
+1.59146715e+00,+8.60937632e-01,+6.72028661e-02,-9.63109109e-01,+7.90399984e-01,
+1.12525654e+00,+4.84434179e-01,+7.69806250e-01,+1.43502693e+00,-9.23700177e-01,
-1.70877435e+00,+6.69950189e-01,+1.14211945e+00,-1.00174257e+00,+1.36840273e+00,
-8.46211392e-01,-1.33920404e+00,-1.71009660e+00,+6.22206159e-01,+1.59743982e+00,
+1.15476886e+00,-1.51572580e+00,-1.95071905e-01,+7.14478008e-01,-3.23933119e-01,
+4.41613021e-01,+1.17882322e-01,+1.32492089e+00,+1.11233280e+00,+7.08115313e-01,
+1.60137241e-01,-9.33269912e-01,-1.34946693e-02,+8.17781540e-01,+9.12353922e-01,
+4.29116062e-01,+1.54414320e+00,+1.85929350e+00,+9.24863919e-01,+5.32528388e-01,
+1.80092829e+00,-1.37042421e+00,+9.67380167e-01,-3.38534999e-01,+1.91542213e+00,
+7.94207821e-01,+1.14472783e+00,+1.91966105e+00,+1.91863908e+00,-3.90791733e-01,
+1.36304930e+00,+4.56345909e-01,+1.20907151e+00,-6.15262060e-01,+1.45595715e+00,
+3.52119601e-01,+2.51486261e-01,+1.72150877e+00,-5.73927423e-01,+1.23389879e+00,
-1.58262889e+00,+1.78167850e+00,-1.05002718e+00,+6.04131292e-01,+5.20938084e-01,
+1.39870751e+00,+7.27343914e-01,-3.90499421e-01,+1.33308611e+00,-5.10505906e-01,
-4.71761780e-01,+1.92612929e+00,-1.79609719e+00,+1.94309060e+00,-1.52581147e+00,
+5.50352842e-01,-1.72797329e+00,-1.65370336e+00,-8.55472189e-01,+1.00658372e+00,
-9.67763822e-01,+1.83022992e+00,+1.22831780e+00,+6.49512410e-01,+1.40558513e+00,
+5.53110339e-01,+1.10488915e+00,+1.54040988e-01,+1.04230634e+00,-8.71786617e-01,
+3.29465480e-01,+4.77577726e-01,-6.29434310e-01,+8.84400406e-01,+5.45061005e-01,
-1.50413513e+00,+5.97780199e-01,+7.59296042e-01,-1.30454484e+00,+2.62037588e-01,
-6.85534409e-01,+1.55452686e+00,+6.76871595e-01,+6.99147414e-01,-6.63104011e-01,
+1.82674575e+00,+7.31991846e-01,}; 
k2c_tensor test2_simple_rnn_input_input = {&test2_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test2_array[5] = {
+0.00000000e+00,+1.00000000e+00,+9.18825708e-37,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test2 = {&keras_dense_test2_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test2_array[5] = {0}; 
k2c_tensor c_dense_test2 = {&c_dense_test2_array[0],1,5,{5,1,1,1,1}}; 
float test3_simple_rnn_input_input_array[122] = {
+8.47831166e-01,-1.11379340e+00,-3.68343789e-01,-1.48939733e-01,+2.26011949e-01,
+1.84820346e+00,-9.07922127e-01,-1.49225796e+00,-4.49579291e-01,-1.14284871e+00,
-7.22535808e-01,+1.70441002e+00,+1.76788304e+00,+1.87076271e+00,-1.26736842e+00,
-1.93367114e-01,-2.58808609e-01,+7.90416703e-01,-1.26259550e+00,-1.50692120e+00,
-3.88493147e-01,+1.02525767e+00,+1.21644287e+00,-4.46121222e-01,-1.60223131e+00,
-1.60457767e+00,-1.97173443e+00,+1.73353535e+00,-1.63940918e+00,-1.16747138e+00,
+1.08193487e+00,-6.95885579e-01,+1.63236315e+00,+1.98695033e-01,-1.58066822e+00,
+1.72509554e+00,-1.91177914e+00,+1.96464206e+00,-2.93810648e-01,-1.18022739e+00,
-1.47859884e+00,-1.13387255e+00,-1.26963843e+00,+1.09591345e+00,+7.59475426e-01,
-4.25379808e-02,-1.62103955e+00,+1.62919444e+00,+1.78162904e+00,-3.63370474e-03,
-1.13952367e+00,+6.03318613e-01,+5.02450639e-01,+4.38833875e-01,-8.67428485e-01,
-4.76081127e-01,+1.36986920e+00,+1.20364163e+00,+1.42709405e+00,+4.32079054e-01,
+4.82280677e-01,+7.93143622e-01,+7.24009661e-02,+7.70935209e-01,-8.73757193e-01,
-1.67922983e+00,-1.89618109e+00,-2.70760838e-01,+4.23441624e-01,+1.56853846e+00,
+1.76372990e+00,+1.54395900e+00,-1.86930361e+00,-3.42394916e-01,+8.92573019e-01,
-3.91711763e-02,+1.20524264e-01,+9.49255567e-02,+4.11229208e-01,+1.97101435e+00,
+1.01928360e+00,-1.15830703e+00,+6.81948681e-01,-1.21589122e+00,-1.82010754e+00,
+1.27999993e-01,+1.04321469e+00,-1.43194295e-02,-9.92678407e-02,-1.68971257e-01,
-2.90107379e-01,-1.06635145e+00,+9.82673856e-01,+1.83270233e+00,-1.07151419e+00,
-1.99521972e+00,+1.70238102e+00,-1.02694960e+00,-1.64725828e+00,-1.86106274e+00,
-1.92266333e+00,-4.60270127e-02,+1.48500604e+00,-5.86938435e-01,-1.98664836e+00,
+1.34620934e+00,+1.67138357e+00,-4.41491041e-01,-2.42659241e-01,+1.47083361e+00,
+9.15633589e-01,-1.86967991e+00,+9.60958174e-01,+2.24203513e-01,-1.05446434e+00,
+6.00452978e-01,-2.20851494e-01,+1.05694550e+00,-9.77042999e-01,+6.13081162e-01,
+1.52928359e+00,+5.30093379e-01,}; 
k2c_tensor test3_simple_rnn_input_input = {&test3_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test3_array[5] = {
+0.00000000e+00,+9.99999404e-01,+5.94103255e-07,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test3 = {&keras_dense_test3_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test3_array[5] = {0}; 
k2c_tensor c_dense_test3 = {&c_dense_test3_array[0],1,5,{5,1,1,1,1}}; 
float test4_simple_rnn_input_input_array[122] = {
-1.14704823e+00,-1.45865785e+00,-7.93769255e-01,-5.25715150e-01,+1.25560161e+00,
-9.33333053e-01,-1.20963008e+00,-8.73902755e-01,-1.20534174e+00,+6.18563201e-02,
-1.48370043e+00,+9.98732018e-02,+2.77617845e-01,-1.30679140e+00,-1.11179750e+00,
-1.33314143e+00,+1.05568288e+00,+1.79020883e+00,-1.37602573e-01,+1.07128398e+00,
-4.93056348e-01,+1.25284423e+00,+1.97503128e+00,-1.57912192e+00,-1.98337219e+00,
-6.06620992e-01,-1.36111412e+00,-1.09397189e+00,+1.84642645e+00,+6.41335915e-01,
-1.88637100e+00,+1.13260283e+00,+1.48153941e+00,+1.55231556e+00,-3.57464463e-03,
-5.22943533e-01,-5.45521020e-01,-8.81359036e-01,+6.23400883e-01,+1.68650864e+00,
-1.84287676e+00,-1.51743720e+00,-5.42864422e-01,-1.74215568e-01,-9.29045687e-01,
+1.37351049e+00,-9.73689553e-01,+1.43509825e+00,+4.94822561e-01,+1.92358444e-01,
-3.10634398e-01,+1.64375119e+00,+1.84607525e+00,-1.06074003e+00,+1.96897316e+00,
+7.03907126e-01,+1.94016304e+00,+3.67430160e-01,-1.72381932e+00,-9.51274437e-01,
-1.79983537e+00,+9.34031058e-01,-5.95076479e-01,-6.74014857e-01,-1.11508409e+00,
-1.45752641e+00,+5.58827586e-01,-1.58730037e+00,+1.10089661e+00,-1.96548411e+00,
-8.02907547e-02,-3.16212775e-01,-1.23576057e+00,-8.31191103e-01,+1.61193447e-01,
-3.48640685e-02,+8.85869211e-01,+6.23400915e-01,+1.07538148e+00,+1.00504142e+00,
+1.65786042e+00,+1.04499965e+00,+1.09186830e+00,-6.72178467e-01,+1.64001729e+00,
-1.53756871e+00,+1.56287253e+00,+1.57166619e+00,+7.32685369e-01,-1.05699226e+00,
-2.76281003e-01,-1.49270150e+00,+1.71419435e+00,+1.22779272e+00,+3.14481895e-01,
-7.54742055e-01,-1.36406752e+00,-1.91651184e-01,-1.32761855e+00,-1.36126157e+00,
-2.80969020e-01,-5.57025718e-01,-1.80147712e+00,-6.15520690e-01,-1.52881322e+00,
-2.24980785e-01,+1.06956629e+00,+8.44260947e-01,-1.29761468e+00,+5.30687815e-01,
-8.19435773e-01,+1.33747159e+00,-1.03343860e-01,-1.55438518e+00,+1.23655989e+00,
-1.01169526e+00,+1.58522141e+00,+9.62725951e-01,+1.72244599e+00,+1.16474238e+00,
+1.87702815e+00,+3.37498228e-01,}; 
k2c_tensor test4_simple_rnn_input_input = {&test4_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test4_array[5] = {
+0.00000000e+00,+4.49236531e-32,+1.00000000e+00,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test4 = {&keras_dense_test4_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test4_array[5] = {0}; 
k2c_tensor c_dense_test4 = {&c_dense_test4_array[0],1,5,{5,1,1,1,1}}; 
float test5_simple_rnn_input_input_array[122] = {
+5.31800097e-01,+7.17743708e-02,+1.00375354e-01,-6.44425159e-01,-1.39426291e+00,
-1.20210964e+00,-1.90301775e+00,-1.69785316e+00,+1.44768085e+00,-1.38762636e+00,
-6.73176779e-01,-1.49683193e+00,-1.80721539e+00,+1.60434366e+00,+1.41197482e+00,
+1.33600726e+00,-1.57552766e+00,+9.38200383e-01,+7.70316185e-02,+6.39607978e-01,
+9.39346982e-01,+2.05533163e-01,-1.29281542e+00,-1.00606681e+00,+1.20266900e+00,
+3.94788981e-02,+8.88010079e-01,-1.02033235e+00,+1.16236084e+00,+1.57364351e+00,
+1.48449456e+00,-2.30681725e-01,-7.17393765e-01,+6.81762690e-01,-1.11069138e+00,
+1.31950867e+00,+1.33556510e-02,-1.93038793e+00,-1.66853106e+00,-3.13079530e-01,
-8.60601813e-01,-1.04409661e+00,-4.49544502e-01,-1.56647529e+00,-1.65751826e+00,
+4.99191442e-02,+4.75332620e-01,+6.04939091e-01,+1.33110799e+00,-3.00560115e-03,
-1.49679803e-01,+1.37290830e+00,-1.54482603e+00,-4.89490481e-01,+9.10626715e-01,
+1.41700090e+00,+1.82722902e+00,-8.62113541e-01,-1.33368117e+00,+1.81830021e+00,
-3.99180284e-01,-1.20888710e+00,+4.76832153e-01,+1.76721717e+00,-9.54480052e-01,
-2.46491768e-01,+1.46316380e+00,-1.72250019e+00,+1.59975248e+00,+1.61709495e+00,
-1.64207248e+00,-1.21820283e+00,+1.77909932e+00,-1.98925225e+00,+3.99173812e-02,
+1.01280685e+00,+1.68629397e+00,-6.90510037e-01,-2.24117697e-01,+2.14753824e-01,
+7.62855441e-01,+3.19723988e-01,-1.40505731e+00,-2.36581997e-01,-1.05724205e+00,
-1.68792873e+00,+3.34452911e-01,+1.14785500e+00,-1.15138386e+00,-5.03596569e-02,
-2.02965322e-01,+1.73823008e+00,-7.00968314e-01,-8.23900763e-01,+1.43390374e+00,
+1.96684443e+00,+1.85215816e+00,-1.98826769e+00,+9.24332995e-01,-1.62416610e+00,
-2.42776782e-01,-1.14462557e+00,+8.42051105e-01,-1.63643375e+00,+1.84057552e+00,
+6.14950835e-01,-7.67677894e-01,+3.09010849e-01,-7.86559463e-01,+6.36025594e-01,
+4.04294563e-02,+1.97619630e+00,-1.45478310e-02,-1.23528328e+00,+1.31192029e+00,
-9.28361205e-01,+1.74232198e+00,-1.87517484e+00,-6.70657628e-01,-4.31944624e-01,
+1.44142870e+00,-7.90411345e-01,}; 
k2c_tensor test5_simple_rnn_input_input = {&test5_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test5_array[5] = {
+6.24406201e-22,+1.00000000e+00,+4.72789720e-18,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test5 = {&keras_dense_test5_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test5_array[5] = {0}; 
k2c_tensor c_dense_test5 = {&c_dense_test5_array[0],1,5,{5,1,1,1,1}}; 
float test6_simple_rnn_input_input_array[122] = {
-1.51662466e+00,+1.40055890e+00,+1.04525941e+00,+1.19416441e-01,-1.42575405e+00,
-7.80576923e-01,+1.29460686e+00,+1.01126578e+00,+1.78487023e+00,+1.37831986e-02,
-1.72284889e+00,+9.07646244e-01,+1.05852084e+00,+1.52547692e-01,-2.70970219e-01,
-1.02340727e-03,+2.22316998e-01,+1.46128972e+00,+4.55722588e-01,-1.96384604e-01,
+5.56805047e-01,+1.52382770e+00,-1.95956518e+00,+1.16613867e+00,-1.47946611e+00,
-1.67500273e+00,-4.19443172e-01,+1.81241568e+00,-1.37152253e-01,-1.52287700e+00,
-9.61457996e-01,+1.66738450e+00,+1.15329084e-01,+6.20269877e-01,-1.04600746e+00,
+1.83784300e+00,-7.57487954e-01,-1.78851621e+00,+1.59309732e+00,-1.92436119e+00,
+1.44639653e+00,-1.11913930e+00,+1.56098105e+00,-1.14773727e+00,+1.64066939e+00,
-1.57336000e+00,-1.78204634e-01,-1.96957352e+00,-6.16220090e-01,-1.75118096e+00,
-6.46446211e-01,-1.02260780e+00,+1.24563732e+00,+3.54314500e-01,-2.28914582e-01,
-1.16213786e+00,+6.07867444e-01,-5.14080372e-01,+1.57616472e+00,-4.92802311e-02,
-1.12623564e-01,-1.03723400e+00,-4.12297037e-02,+1.27691841e+00,+2.97674210e-01,
+6.66332832e-02,-1.21759445e+00,+5.81684700e-01,-7.52706481e-01,+4.99576254e-01,
-1.81525153e-01,-6.46891526e-01,-5.47196932e-01,+3.98601755e-01,+1.83289387e+00,
+1.53498446e+00,-3.92956817e-01,+2.35580024e-01,+4.37749948e-01,-2.12526091e-01,
+1.18713122e+00,+3.06440100e-01,-6.79281944e-01,+1.07392457e+00,-1.61749229e+00,
-1.19642486e+00,-1.38155440e+00,+5.56007482e-01,+1.85858710e+00,-3.18591581e-01,
+8.32661612e-01,+1.68206431e+00,+1.18824738e+00,-6.38437502e-01,-1.59076529e+00,
-9.88782476e-01,+1.66909544e+00,+1.01371290e+00,+1.32505581e-01,-5.59699480e-01,
-1.28375040e+00,+1.53585261e+00,+1.83816035e-01,-1.03054118e+00,+1.77414472e+00,
+1.67454288e+00,+9.48464890e-01,-1.18443965e+00,+1.28895802e+00,+1.60503691e+00,
-1.93842951e+00,-8.63497879e-01,+1.10755892e+00,-1.78892011e+00,+2.99001069e-01,
-8.46482330e-01,-3.10618139e-01,-5.10494863e-01,+1.96522768e+00,-1.63493473e+00,
-8.87952084e-01,-1.63938481e+00,}; 
k2c_tensor test6_simple_rnn_input_input = {&test6_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test6_array[5] = {
+0.00000000e+00,+1.00000000e+00,+5.05267498e-32,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test6 = {&keras_dense_test6_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test6_array[5] = {0}; 
k2c_tensor c_dense_test6 = {&c_dense_test6_array[0],1,5,{5,1,1,1,1}}; 
float test7_simple_rnn_input_input_array[122] = {
-1.23510695e+00,-1.80863821e+00,+2.75500599e-01,-1.28551901e+00,+6.95458409e-01,
-6.98668452e-01,+1.16291517e-02,+1.00562266e+00,+1.07043266e+00,-1.85930653e+00,
+5.67409954e-01,+9.72337112e-01,+1.47024602e+00,+1.53616576e+00,-1.26960196e+00,
+6.10677408e-02,+1.89340532e+00,+8.03993752e-01,-1.64053896e+00,-1.76278659e+00,
-1.70807193e+00,+7.22207455e-01,+1.04780962e+00,+8.89353902e-01,-8.62928460e-03,
-9.10007257e-01,-1.12183996e+00,+1.90743246e+00,+6.65441283e-01,-5.50499358e-02,
-1.26104879e+00,-1.48653164e+00,-1.41784676e+00,-1.98805963e+00,-4.67381059e-01,
+1.88845901e+00,-7.42069651e-01,-1.83905957e+00,-2.75967243e-01,-4.43116678e-01,
-3.76573959e-01,-2.58228884e-01,+1.32027970e+00,+1.02711623e+00,-8.66524712e-01,
+4.64848895e-01,+4.44922484e-01,+1.07215824e+00,-1.20968402e+00,-1.64454268e+00,
-1.74866143e+00,+1.35081609e+00,-2.91691622e-01,+3.90266822e-01,+1.99905890e+00,
-6.62697608e-01,-1.15302804e+00,-1.68258450e+00,+1.04634917e+00,+1.95406376e+00,
+1.25884654e+00,+6.54731469e-01,+5.81926999e-01,+1.78338641e-01,-9.06025078e-01,
+3.63866429e-01,+9.81965175e-01,+1.87017152e+00,+8.90476563e-01,-4.05578947e-02,
+2.11905186e-01,-1.51559983e+00,-1.24530111e+00,-1.39543934e+00,-1.11028935e+00,
+1.23449975e+00,+1.32457459e-01,+1.84466684e+00,+4.53922597e-01,-1.15810600e-01,
-4.21220139e-01,-3.72506684e-01,+1.14479166e+00,+3.29460461e-01,-1.34755355e+00,
-1.04084638e+00,-1.78930091e+00,-6.28173130e-01,+8.35563278e-01,-6.82464361e-01,
-1.11638385e+00,-1.30871060e+00,-1.04015961e+00,-1.93035426e+00,-1.95963646e+00,
-1.21307858e+00,-1.99648421e+00,+1.86845222e+00,-3.08836030e-01,+5.41689517e-01,
+9.14426535e-01,-8.03307399e-01,-9.61684051e-01,-1.00216440e+00,+1.94742972e+00,
-9.62958070e-01,+1.01095517e+00,+1.23223858e+00,+4.52899732e-01,-9.12695942e-01,
+1.96767286e+00,-1.85747657e+00,+8.82934880e-01,+3.05088966e-01,+4.50391576e-01,
+7.74861053e-01,-1.37130724e+00,+1.56436094e+00,-1.18569336e+00,-1.30408767e+00,
+7.64822581e-01,-1.85296109e+00,}; 
k2c_tensor test7_simple_rnn_input_input = {&test7_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test7_array[5] = {
+0.00000000e+00,+1.00000000e+00,+2.70852646e-11,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test7 = {&keras_dense_test7_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test7_array[5] = {0}; 
k2c_tensor c_dense_test7 = {&c_dense_test7_array[0],1,5,{5,1,1,1,1}}; 
float test8_simple_rnn_input_input_array[122] = {
+1.17987956e-01,-1.33739322e+00,+1.79827070e+00,-8.79738399e-01,-7.32618178e-01,
+1.70829453e-01,-1.67779982e+00,-1.93550615e+00,-1.46739832e+00,+1.75352799e+00,
+7.88589172e-01,+1.63623094e+00,-1.05939531e+00,+1.71199861e+00,-1.51106493e+00,
+7.22783108e-01,+1.13245876e+00,+1.18192555e+00,+1.05490496e+00,-1.22688989e+00,
-5.84132982e-01,-1.77559150e+00,+7.80258874e-01,-2.47233448e-01,-1.35982729e+00,
+8.85295173e-01,+3.66985174e-01,+9.99766704e-01,+1.84250515e+00,-2.63816822e-01,
+1.77157053e+00,-2.60106498e-01,+1.22943994e+00,-1.42399238e+00,+1.80569590e+00,
-1.10356538e+00,+9.92561899e-01,-7.56914481e-01,-1.41041587e+00,-1.97050718e+00,
-5.59661027e-01,-1.65086432e+00,+1.69000109e+00,+4.53444504e-01,+1.01658538e+00,
+1.71509665e+00,-6.73882684e-02,+1.83986490e+00,+1.77912040e+00,+1.14782765e-01,
-2.10386171e-01,-1.72924925e+00,-8.37463889e-01,-1.16282268e+00,-4.91403205e-02,
+4.51951979e-01,+2.69453480e-01,+9.00831492e-01,+1.70295230e+00,+1.30907178e-01,
+7.46309966e-03,-1.24020743e+00,+1.37711016e+00,+6.32855567e-01,-1.54341591e+00,
+7.66654201e-01,-1.13549015e+00,-1.23002288e+00,+1.97552873e+00,-3.72698769e-01,
-1.41399348e-01,+1.94223729e-01,-1.87991912e+00,+1.05678648e+00,+8.08655672e-01,
-1.22489239e+00,+1.20766806e-01,-9.03647785e-01,+3.87384660e-02,-1.42015929e-01,
+1.75696564e+00,-6.23859754e-01,-1.19551346e-01,-1.36083178e+00,+1.46128205e+00,
-4.05671355e-02,-6.32349222e-01,+1.59136856e+00,+2.26256518e-01,-6.90994639e-01,
-1.05052533e+00,+1.89684325e+00,-1.17565472e+00,+1.76538367e+00,-1.66709663e-01,
-1.66101060e+00,+1.17701874e+00,-1.27209610e+00,-9.37079566e-01,+7.62416806e-01,
+9.42086739e-01,-3.92465862e-01,-4.19581449e-01,+1.91109260e+00,-5.29652023e-01,
-3.09554257e-01,+2.71442930e-01,+1.09100854e-01,-1.93853091e+00,+7.50815134e-01,
-4.53881391e-01,+1.19169654e+00,+1.28086925e+00,-1.79944766e+00,-4.08038036e-01,
+1.02812514e-01,+1.02747407e+00,-1.37881422e+00,-1.01129822e+00,-4.31718276e-01,
-2.29182001e-01,-1.59224654e+00,}; 
k2c_tensor test8_simple_rnn_input_input = {&test8_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test8_array[5] = {
+0.00000000e+00,+3.05715560e-07,+9.99999642e-01,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test8 = {&keras_dense_test8_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test8_array[5] = {0}; 
k2c_tensor c_dense_test8 = {&c_dense_test8_array[0],1,5,{5,1,1,1,1}}; 
float test9_simple_rnn_input_input_array[122] = {
+1.32961298e-01,-7.42291763e-01,+1.89678840e+00,-3.19839803e-01,-1.45247811e+00,
-8.90987890e-01,-3.13418401e-01,+1.73251905e+00,-1.25260418e+00,-7.37404670e-01,
+6.64436444e-01,-1.20323534e-01,+1.97272776e+00,+8.10804559e-01,+1.84785605e+00,
-1.73971185e+00,+1.39393466e+00,+5.30632639e-01,-1.59052273e+00,-1.42825936e+00,
-1.24042485e+00,+4.27938014e-01,-1.76011791e+00,-4.77103252e-01,-1.20105058e+00,
-1.83165858e+00,-1.55161854e+00,-1.14424125e+00,-9.05286336e-01,+1.56526591e+00,
+3.50255049e-01,+8.65433668e-01,-4.88573795e-01,-1.17299720e+00,+3.31417412e-01,
+6.82461613e-01,+1.70029336e+00,+9.49210610e-01,-1.63334111e+00,+1.34774956e+00,
-1.71766356e-01,+8.19200914e-01,+5.70374418e-01,-4.67291097e-01,+1.81023728e+00,
-1.51244067e-01,+9.81972290e-01,+3.29551460e-01,+3.12747596e-01,+1.33432679e+00,
+1.05607842e+00,+1.39251412e-01,+4.79576647e-01,+1.34109751e+00,+1.14505501e+00,
-1.64238772e+00,+6.55795078e-01,-1.51451188e+00,-3.77299885e-01,-1.28945803e+00,
+1.03567230e+00,+1.87477375e+00,+1.75772753e-01,+1.18432556e+00,-1.78749300e-01,
+9.82398297e-01,+1.50616918e+00,-1.61403991e+00,+1.42349356e-01,-1.27290574e+00,
-2.97212713e-01,-8.08210673e-01,+8.48659761e-01,+9.61044507e-01,+1.30649971e+00,
+3.49546937e-01,-6.19084535e-01,-8.80322967e-01,-1.93324182e+00,+1.48764175e+00,
+1.88130474e+00,+1.01653682e+00,-1.59818314e+00,+6.14235435e-02,+1.64527657e+00,
-4.81717573e-01,-7.29995763e-01,-1.21757665e+00,-1.22626768e+00,-1.81410310e-01,
+7.92906632e-02,-2.68097167e-01,-1.97886178e+00,+9.85431967e-01,-1.19908977e+00,
-1.38103002e+00,+1.11777504e-01,-1.86240427e+00,-4.91050496e-01,+1.71729325e+00,
+1.55124671e+00,+1.33796195e+00,+1.30733804e+00,-8.53822549e-01,-9.91441786e-01,
+1.59282167e+00,+7.42416909e-01,-1.86194125e-01,+1.50942600e+00,-1.86003088e+00,
-1.83996134e+00,+8.71679253e-01,+6.11192534e-01,-1.45801842e+00,-1.46911194e+00,
+1.19365123e+00,+1.88029926e+00,-1.00423333e+00,-1.35309539e+00,+2.27489375e-02,
-7.70207525e-01,-9.75039367e-01,}; 
k2c_tensor test9_simple_rnn_input_input = {&test9_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test9_array[5] = {
+0.00000000e+00,+1.00000000e+00,+0.00000000e+00,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test9 = {&keras_dense_test9_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test9_array[5] = {0}; 
k2c_tensor c_dense_test9 = {&c_dense_test9_array[0],1,5,{5,1,1,1,1}}; 
float test10_simple_rnn_input_input_array[122] = {
-1.86786041e+00,-4.32611608e-02,-9.42268026e-01,-1.61841313e+00,-1.46621390e+00,
-6.57618676e-01,+1.38676190e+00,+1.04278016e+00,-1.43713177e+00,-6.07870350e-01,
+8.73147897e-01,-4.55811398e-01,+1.53221968e+00,+4.87147670e-01,+1.43152729e+00,
-6.16516766e-01,+3.00666074e-01,+1.81335900e+00,-1.12269351e+00,-5.72179320e-01,
+6.71925778e-01,-9.08229854e-01,+6.05289214e-01,+6.91486839e-01,-7.31945803e-01,
+1.32205463e+00,-3.51626888e-01,+1.90195192e+00,-1.75558135e+00,+1.92229617e+00,
-1.46929684e-01,-3.90823746e-01,-7.40163331e-01,+9.61543386e-01,+2.66867023e-01,
-5.47097824e-01,-5.48611208e-02,-1.98417472e+00,+3.89443086e-01,-1.01261720e+00,
-1.67917455e+00,+6.44235493e-01,+7.91104969e-01,+1.34315085e+00,-1.70980645e+00,
+1.62294331e+00,+1.21675639e+00,+1.87733519e+00,-4.47629000e-01,-1.97753690e+00,
-1.02014611e+00,+5.24317806e-03,+7.62734345e-02,+1.63948312e+00,+1.20439527e+00,
-1.45333571e+00,-8.26723155e-01,+7.91628990e-01,+1.27492344e+00,+5.59739453e-01,
+8.93911491e-02,+1.35268068e+00,-1.91295713e+00,-4.03542787e-01,+1.64390285e+00,
-7.22730618e-02,+1.05343328e-02,+8.44351538e-01,+9.59134420e-01,-8.89457866e-01,
-1.32002034e+00,-1.82145930e+00,-1.85128840e+00,-1.25022170e+00,-1.54318328e+00,
+1.24001471e+00,+1.65785959e+00,-6.74071867e-02,-9.51090707e-01,+9.31611878e-01,
-1.16969084e+00,+8.62995770e-01,+9.01119636e-01,+8.16264547e-01,-4.51268364e-01,
-8.93387288e-01,+4.85292810e-02,-1.48807197e+00,+1.22648882e+00,+1.55125768e+00,
-5.26406616e-01,-1.66250390e+00,+1.64822297e+00,+4.00242986e-02,-2.74861018e-01,
+1.43717248e+00,-8.41340300e-01,-1.58743566e+00,-3.87500205e-01,-1.44257015e+00,
+8.69685759e-01,+3.47817751e-01,+4.52205592e-02,+1.64023237e+00,+1.76749116e+00,
-1.31391341e-01,-1.58587451e+00,-8.37513502e-02,+9.58248087e-01,+1.46185842e+00,
-1.62786349e+00,+7.35186686e-01,+9.10287332e-01,-1.06008284e+00,+2.14958371e-01,
-2.19979560e-01,+1.65103358e+00,+2.78203346e-01,-1.57999536e+00,-4.17175825e-01,
+5.86197955e-01,-1.71005096e-01,}; 
k2c_tensor test10_simple_rnn_input_input = {&test10_simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
float keras_dense_test10_array[5] = {
+0.00000000e+00,+1.00000000e+00,+0.00000000e+00,+0.00000000e+00,+0.00000000e+00,
}; 
k2c_tensor keras_dense_test10 = {&keras_dense_test10_array[0],1,5,{5,1,1,1,1}}; 
float c_dense_test10_array[5] = {0}; 
k2c_tensor c_dense_test10 = {&c_dense_test10_array[0],1,5,{5,1,1,1,1}}; 
 float errors[10];
 size_t num_tests = 1; 
size_t num_outputs = 1; 
float* simple_rnn_output_array; 
float* simple_rnn_kernel_array; 
float* simple_rnn_recurrent_kernel_array; 
float* simple_rnn_bias_array; 
float* dense_kernel_array; 
float* dense_bias_array; 

int max = 1024;
int cnt = 0;
FILE *f = fopen("simpleRNNIDS_train.csv", "r");
char line[max];
char *pLine;

FILE *result = fopen("simpleRNNIDS_test.csv", "r");
char reline[max];
char *reLine;

int k = 0;
clock_t t0 = clock(); 
while(!feof(f)) {
    pLine = fgets(line, max, f);
    char *ptr = strtok(pLine, ",");
    float simple_rnn_input_input_array[122] = {0.0};
    int i = 0;
    while (ptr != NULL) {
        if (i == 122) break;
        simple_rnn_input_input_array[i] = atof(ptr);
        ptr = strtok(NULL, ",");
        i++;
    }
    
    k2c_tensor simple_rnn_input_input = {&simple_rnn_input_input_array[0],2,122,{  1,122,  1,  1,  1}}; 
    
    rnnIDS_initialize(&simple_rnn_output_array,&simple_rnn_kernel_array,&simple_rnn_recurrent_kernel_array,&simple_rnn_bias_array,&dense_kernel_array,&dense_bias_array); 
    rnnIDS(&simple_rnn_input_input,&c_dense_test1,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 

    reLine = fgets(reline, max, result);
    char *reptr = strtok(reLine, ",");
    float test_result[5] = {0.0};
    int j = 0;
    int re_max_index;
    while (reptr != NULL) {
        if (j == 5) break;
        if (atof(reptr) == 1.0) re_max_index = j;
        reptr = strtok(NULL, ",");
        j++;
    }

    int max_index = -1;
    float max_value = -1;
    for (int i = 0; i < 5; i++) {
        if (c_dense_test1_array[i] > max_value) {
            max_value = c_dense_test1_array[i];
            max_index = i;
        }
    }
    // printf("%d max: index %d value %f\n", k, max_index, max_value);

    if (max_index == re_max_index) cnt ++;
    rnnIDS_terminate(simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 

    k++;
}

printf("cnt: %d\n", cnt);
printf("Accuracy : %f%%\n",((float)cnt/(float)k)*100);

fclose(f);

clock_t t1 = clock(); 
printf("Average time over %d tests: %e s \n",k, 
(double)(t1-t0)/(double)CLOCKS_PER_SEC/(double)k); 

// rnnIDS(&test1_simple_rnn_input_input,&c_dense_test1,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test2_simple_rnn_input_input,&c_dense_test2,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test3_simple_rnn_input_input,&c_dense_test3,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test4_simple_rnn_input_input,&c_dense_test4,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test5_simple_rnn_input_input,&c_dense_test5,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test6_simple_rnn_input_input,&c_dense_test6,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test7_simple_rnn_input_input,&c_dense_test7,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test8_simple_rnn_input_input,&c_dense_test8,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test9_simple_rnn_input_input,&c_dense_test9,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 
// rnnIDS(&test10_simple_rnn_input_input,&c_dense_test10,simple_rnn_output_array,simple_rnn_kernel_array,simple_rnn_recurrent_kernel_array,simple_rnn_bias_array,dense_kernel_array,dense_bias_array); 

// errors[0] = maxabs(&keras_dense_test1,&c_dense_test1); 
// errors[1] = maxabs(&keras_dense_test2,&c_dense_test2); 
// errors[2] = maxabs(&keras_dense_test3,&c_dense_test3); 
// errors[3] = maxabs(&keras_dense_test4,&c_dense_test4); 
// errors[4] = maxabs(&keras_dense_test5,&c_dense_test5); 
// errors[5] = maxabs(&keras_dense_test6,&c_dense_test6); 
// errors[6] = maxabs(&keras_dense_test7,&c_dense_test7); 
// errors[7] = maxabs(&keras_dense_test8,&c_dense_test8); 
// errors[8] = maxabs(&keras_dense_test9,&c_dense_test9); 
// errors[9] = maxabs(&keras_dense_test10,&c_dense_test10); 
// float maxerror = errors[0]; 
// for(size_t i=1; i< num_tests*num_outputs;i++){ 
// if (errors[i] > maxerror) { 
// maxerror = errors[i];}} 
// printf("Max absolute error for 10 tests: %e \n", maxerror);

// if (maxerror > 1e-05) { 
// return 1;} 

return 0;
} 

float maxabs(k2c_tensor *tensor1, k2c_tensor *tensor2){ 

    float x = 0; 

    float y = 0; 

    for(size_t i=0; i<tensor1->numel; i++){

    y = fabs(tensor1->array[i]-tensor2->array[i]);
    if (y>x) {x=y;}}
    return x;}

